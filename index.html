<script>
    const codeMapping = {
        "group1": {
            codes: ["8H6BQBCKWUIB", "TGNFA2YHX8U9", "J9IYQMBDHSHY", "NMBO4QINVG93"],
            account: "nerendigbocr@yahoo.com",    // 泰坦之旅
            password: "Tt994488"
        },
        "group2": {
            codes: ["DPEI5NJADZF7", "F98POBZZ1PBI", "J69T1R77M5LW", "ZRVC2XR1SHLZ"],
            account: "eelkemambfsau@yahoo.com",    // 王国1-3
            password: "Tt996644"
        },
        "group3": {
            codes: ["J9N8EO2RNL5X", "HIHJIT7EY0X6", "GUY3B5WGUQV6", "O1FLDV4J1WGL"],
            account: "m6veyod8p16f@gmx.com",    // 保卫战1-5
            password: "Tt996644"
        },
        "group4": {
            codes: ["5F3TXBXTLC2L", "LJ18U1F0S7QO", "BCW25368JT6F", "LA3I8ALR28IT"],
            account: "m5qdcj@hxyml.com",    // 北境之地
            password: "1tcGSk5r2W"
        },
        "group5": {
            codes: ["6L5QX6S56GPJ", "96UYAIS6NQHK", "2M674G4M5EYR", "1NMQUOEQD6HA"],
            account: "example5@mail.com",    // 备用2
            password: "P@ssw0rd5"
        }
    };
</script>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>兑换码管理</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 10px;
            background-color: #f5f5f5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .top-text {
            color: red;
            font-size: 18px;
            font-weight: bold;
            margin: 10px 0;
            text-align: center;
            flex-shrink: 0;  /* 防止压缩 */
        }

        .image-container {
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            flex-shrink: 0;  /* 防止压缩 */
        }

        img {
            width: 100%;
            height: auto;
            display: block;
        }

        .content-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 15px 0;
            flex-shrink: 0;  /* 防止压缩 */
        }

        .input-section {
            width: 100%;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;  /* 增加底部间距 */
        }

        #copy-section {
            display: none;
            width: 100%;
            max-width: 400px;
            gap: 10px;
            flex-direction: column;
        }

        button {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border-radius: 8px;
            border: none;
            background: #007AFF;
            color: white;
        }

        input {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
        }

        h1 {
            font-size: 16px;
            margin: 10px 0;
        }

        .bottom-section {
            margin-top: auto;  /* 推到底部 */
            flex-shrink: 0;    /* 防止压缩 */
        }

        .bottom-text {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }

        .red-text {
            color: red;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .highlighted-text {
            color: #007AFF;
            font-size: 16px;
            font-weight: bold;
        }

        .yellow-text {
            color: #666;
            font-size: 14px;
            line-height: 1.5;
            margin: 10px 0;
            display: flex;
            align-items: center;
        }

        .yellow-text::before {
            content: "•";
            color: #007AFF;
            font-size: 20px;
            margin-right: 8px;
        }

        .bottom-red-text {
            color: #999;
            font-size: 12px;
            text-align: center;
            margin: 15px 0;
            padding: 0 15px;
        }
    </style>
</head>
<body>
    <div class="top-text">
        ☆☆☆严格把教程看完☆☆☆
    </div>

    <div class="image-container">
        <img src="assets/jc.png" alt="教程说明">
    </div>

    <div class="content-wrapper">
        <div class="input-section">
            <h1>输入兑换码</h1>
            <input type="text" id="code-input" placeholder="请输入兑换码">
            <button onclick="verifyCode()">验证</button>
        </div>

        <div id="copy-section">
            <button id="copy-account">复制账号</button>
            <button id="copy-password">复制密码</button>
        </div>
    </div>

    <div class="bottom-section">
        <div class="bottom-text">
            <p class="red-text">注意事项！！！</p>
            <p class="yellow-text">请不要在淘宝说（账号，id，ios，美区）等敏感词</p>
            <p class="yellow-text">有售后问题请直接咨询VX客服：<span class="highlighted-text">Tbb_0vO</span></p>
        </div>

        <div class="bottom-red-text">
            * 请勿恶意咨询违禁词，客服将不给与回复，如有问题请联系VX客服 *
        </div>
    </div>

    <script>
        // 禁用右键
        document.addEventListener("contextmenu", function(event) {
            event.preventDefault();
        });

        // 禁用 F12
        document.addEventListener("keydown", function(event) {
            if (event.key === "F12" || (event.ctrlKey && event.shiftKey && event.key === "I")) {
                event.preventDefault();
            }
        });

        const cooldownTime = 3 * 30 * 24 * 60 * 60 * 1000;  // 90天
        const activeTime = 24 * 60 * 60 * 1000;  // 24小时

        function verifyCode() {
            const userCode = document.getElementById("code-input").value;
            let found = false;

            for (const key in codeMapping) {
                const group = codeMapping[key];
                if (group.codes.includes(userCode)) {
                    const lastUsedTime = getLastUsedTime(userCode);
                    const now = Date.now();

                    if (lastUsedTime) {
                        const timeDiff = now - lastUsedTime;
                        
                        if (timeDiff <= activeTime) {
                            // 在24小时活跃期内，允许使用
                            showSuccessResult(group);
                            found = true;
                            break;
                        } else if (timeDiff < cooldownTime) {
                            // 超过24小时但未到90天，提示无效
                            alert("兑换码正在冷却中，请等待" + Math.ceil((cooldownTime - timeDiff) / (24 * 60 * 60 * 1000)) + "天后再试！");
                            return;
                        } else {
                            // 超过90天，可以重新使用
                            setLastUsedTime(userCode);
                            showSuccessResult(group);
                            found = true;
                            break;
                        }
                    } else {
                        // 首次使用
                        setLastUsedTime(userCode);
                        showSuccessResult(group);
                        found = true;
                        break;
                    }
                }
            }

            if (!found) {
                alert("兑换码错误！");
                document.getElementById("copy-section").style.display = "none";
            }
        }

        // 显示成功结果
        function showSuccessResult(group) {
            document.getElementById("copy-section").style.display = "block";
            document.getElementById("copy-account").onclick = () => copyToClipboard("成功复制账号", group.account);
            document.getElementById("copy-password").onclick = () => copyToClipboard("成功复制密码", group.password);
            alert("兑换成功，24小时内可以重复使用！");
        }

        function isCooldownOver(lastUsedTime) {
            return Date.now() - lastUsedTime >= cooldownTime;
        }

        function setLastUsedTime(code) {
            localStorage.setItem(`lastUsed_${code}`, Date.now());
        }

        function getLastUsedTime(code) {
            const lastUsedTime = localStorage.getItem(`lastUsed_${code}`);
            return lastUsedTime ? parseInt(lastUsedTime, 10) : null;
        }

        function copyToClipboard(message, content) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(content)
                    .then(() => alert(message))
                    .catch(err => console.error("复制失败:", err));
            } else {
                fallbackCopyToClipboard(message, content);
            }
        }

        function fallbackCopyToClipboard(message, text) {
            const textarea = document.createElement("textarea");
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand("copy");
                alert(message);
            } catch (err) {
                console.error("复制失败", err);
            }
            document.body.removeChild(textarea);
        }
    </script>
</body>
</html>
